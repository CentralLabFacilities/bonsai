<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coding Guidelines &mdash; Bonsai Docs 0.7-SNAPSHOT documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=b90832ea"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bonsai Core Tutorial" href="general.html" />
    <link rel="prev" title="Bonsai - Bielefeld Sensor Actuator Interface" href="../general.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Bonsai Docs
              <img src="../_static/bonsai-l1s.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">QuickStart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../general.html">Bonsai</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Coding Guideline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#skills">Skills</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usage-documentation">Usage Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code-comments">Code Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#naming-of-variables">Naming of Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ordering-of-variables">Ordering of Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#order-of-methods">Order of methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-use-init-execute-and-end">How to use init(), execute() and end()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defensive-recalling-and-memorizing-of-slots">Defensive recalling and memorizing of slots</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#statemachines">Statemachines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#location">Location</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Usage Documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="general.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="skills.html">Skills</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">Memory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../behavior.html">SCXML Behavior Engine</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bonsai Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../general.html">Bonsai - Bielefeld Sensor Actuator Interface</a></li>
      <li class="breadcrumb-item active">Coding Guidelines</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="coding-guidelines">
<h1>Coding Guidelines<a class="headerlink" href="#coding-guidelines" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some things are Team ToBI (Robocupathome Team of Bielefeld) specific</p>
</div>
<p>All Skills and behaviours in bonsai-skills shall be properly documented.</p>
<section id="skills">
<h2>Skills<a class="headerlink" href="#skills" title="Link to this heading"></a></h2>
<p>Reference Skills:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">knowledge</span><span class="o">.</span><span class="n">SetTargetByKnowledgeBase</span>
<span class="n">nav</span><span class="o">.</span><span class="n">drive</span><span class="o">.</span><span class="n">NavigateTo</span>
</pre></div>
</div>
<section id="usage-documentation">
<h3>Usage Documentation<a class="headerlink" href="#usage-documentation" title="Link to this heading"></a></h3>
<p>Above the class declaration of the skill there should be a short paragraph highlighting the usage of the skill. It shall be of the form:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>A short summary of what this skill does exactly.

&lt;pre&gt;
Options:
A summary of the optional data this skill can be given. Each shall be of the form:
#_KEY_NAME: [type of the key] *additional information such as &quot;Optional (default: defaultvalue)&quot;*

Slots:
A summary of what slots this skill reads/writes. Each shall be of the form:
NameOfTheSlot: [type of the slot] [Read or Write] *additional information such as &quot;optional&quot;*
        -&gt; Description of what this slot exactly contains

ExitTokens:
A summary of which ExitTokens this skill uses. Each shall be of the form:
exittoken.name.as.encountered.in.scxml         Description of why this ExitToken was set

Actuators:
A summary of the actuators used by this skill. Each shall be of the form:
ActuatorName as given in the bonsai-config: [Type of the Actuator]
    -&gt; Reason why/ how/ what this Actuator is used (for)

Sensors:
Analogous to  Actuators.
&lt;/pre&gt;
</pre></div>
</div>
</section>
<section id="code-comments">
<h3>Code Comments<a class="headerlink" href="#code-comments" title="Link to this heading"></a></h3>
<p>Please only comment complex code fragments and avoid only declarative statements such as <cite>retrieving slot</cite>, <cite>keys</cite> / <cite>exittokens</cite>/ <cite>actuators</cite> as they clutter the skill and should be obvious if the other guidelines are respected. Other often used code blocks, such as blocks to retrieve slot contents should not be commented, as they are widely used and their usage should be obvious.</p>
</section>
<section id="naming-of-variables">
<h3>Naming of Variables<a class="headerlink" href="#naming-of-variables" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Parameter Keys should be prefixed with <cite>KEY_</cite>
- The Key value should be prefixed with <cite>#_</cite></p></li>
<li><p>ExitTokens should start with <cite>token</cite></p></li>
</ul>
</section>
<section id="ordering-of-variables">
<h3>Ordering of Variables<a class="headerlink" href="#ordering-of-variables" title="Link to this heading"></a></h3>
<p>Variables shall be declared (and used in configure) in the following order:</p>
<ol class="arabic simple">
<li><p>Keys</p></li>
<li><p>Variables for storing key-values</p></li>
<li><p>ExitTokens</p></li>
<li><p>MemorySlotReader/Writer</p></li>
<li><p>Actuators and Sensors</p></li>
<li><p>Variables for Slot values</p></li>
<li><p>Variables used</p></li>
</ol>
<p>Each kind of variable should form a block (no blank lines) and be seperated by others via a blank line.</p>
</section>
<section id="order-of-methods">
<h3>Order of methods<a class="headerlink" href="#order-of-methods" title="Link to this heading"></a></h3>
<p>The methods of a skill shall always be in the following order:</p>
<ol class="arabic simple">
<li><p>configure()</p></li>
<li><p>init()</p></li>
<li><p>execute()</p></li>
<li><p>end()</p></li>
<li><p>other custom methods used by the skill</p></li>
</ol>
</section>
<section id="how-to-use-init-execute-and-end">
<h3>How to use init(), execute() and end()<a class="headerlink" href="#how-to-use-init-execute-and-end" title="Link to this heading"></a></h3>
<section id="init">
<h4>init()<a class="headerlink" href="#init" title="Link to this heading"></a></h4>
<p>init() shall mainly be used to retrieve slots and prepare acutator calls.</p>
</section>
<section id="execute">
<h4>execute()<a class="headerlink" href="#execute" title="Link to this heading"></a></h4>
<p>execute() shall never block. Actuator calls should always either return a Future, over which should be looped, or timeout after some time. Looping because of waiting should never be done inside execute(), but rather be realized via returning ExitToken.loop(). Because of this, it is best practice to call an actuator in init and return ExitToken.loop() as long as the Future returned by the actuator call is not done.</p>
</section>
<section id="end">
<h4>end()<a class="headerlink" href="#end" title="Link to this heading"></a></h4>
<p>end() shall mainly be used for memorizing data. Please note that end is invoked even if init returns false. This means that in most cases you would want to check for the given ExitToken before you e.g. memorize some variable.</p>
</section>
</section>
<section id="defensive-recalling-and-memorizing-of-slots">
<h3>Defensive recalling and memorizing of slots<a class="headerlink" href="#defensive-recalling-and-memorizing-of-slots" title="Link to this heading"></a></h3>
<p>Recalling and memorizing should always be followed by by a check if the recalled object is null, in case the recalled slot was emtpy. It shall also always be accompanied by understandable logger outputs, at least in the case of an error/ exception.</p>
</section>
</section>
<section id="statemachines">
<h2>Statemachines<a class="headerlink" href="#statemachines" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Skills should <em>NOT</em> be given scxml data parameter <code class="docutils literal notranslate"><span class="pre">&#64;DATA</span></code> if this changes the configure requests.</p></li>
</ul>
<p><em>ExampleSkill</em> <code class="docutils literal notranslate"><span class="pre">Configure()</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">useAct</span> <span class="o">=</span> <span class="n">configurator</span><span class="p">.</span><span class="na">requestOptionalBool</span><span class="p">(</span><span class="s">&quot;#_USE&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="n">useAct</span><span class="p">)</span> <span class="n">act</span> <span class="o">=</span> <span class="n">configurator</span><span class="p">.</span><span class="na">getActuator</span><span class="p">(</span><span class="s">&quot;Foo&quot;</span><span class="p">,</span> <span class="n">Bar</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">#_USE</span></code> is set to <code class="docutils literal notranslate"><span class="pre">&#64;DATA</span></code> with expression <code class="docutils literal notranslate"><span class="pre">false</span></code> during LOAD but gets changed to <code class="docutils literal notranslate"><span class="pre">true</span></code> with <code class="docutils literal notranslate"><span class="pre">&lt;assign&gt;</span></code> the State will not function properly</p>
<section id="location">
<h3>Location<a class="headerlink" href="#location" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Robocup Task SCXML should be created in the <code class="docutils literal notranslate"><span class="pre">robocupathome-dist/scxml</span></code> project</p></li>
<li><p>Documented Behavior SCXML that uses _only_ core skills should be moved to the <code class="docutils literal notranslate"><span class="pre">scxml-common</span></code> project</p></li>
</ul>
<p>Reference Behaviours:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nav</span><span class="o">.</span><span class="n">navigateToAnnotation</span>
<span class="n">knowledge</span><span class="o">.</span><span class="n">storeCurrentPosition</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3>Usage Documentation<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>Above the statemachine there should always be a short paragraph to describe the behaviour. It shall be of the form:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!--&gt;</span>
<span class="cm">A summary what this behaviour exactly does.</span>

<span class="cm">Used Slots:</span>
<span class="cm">A short summary of the Slots this Behaviour gets/writes its data from/to</span>
<span class="cm">    What this specific slot is used for:</span>
<span class="cm">    -&gt; xpath=&quot;/nameOfTheBehaviour/slotName&quot;</span>

<span class="cm">A state declaration, ready to be copy-pasted and slightly adjusted. Example:</span>
<span class="cm">&lt;state id=&quot;navigateToPerson&quot; src=&quot;${ROBOCUP}/behavior/nav/navigateToPerson.xml&quot;&gt;</span>
<span class="cm">        &lt;onentry&gt;</span>
<span class="cm">                &lt;assign location=&quot;personLostTimeout&quot;    expr=&quot;100&quot;/&gt;</span>
<span class="cm">                &lt;assign location=&quot;stopDistance&quot;         expr=&quot;800&quot;/&gt;</span>
<span class="cm">                &lt;assign location=&quot;strategy&quot;             expr=&quot;NearestToTarget&quot;/&gt;</span>
<span class="cm">                &lt;assign location=&quot;refindDistance&quot;       expr=&quot;800&quot;/&gt;</span>
<span class="cm">        &lt;/onentry&gt;</span>
<span class="cm">        &lt;transition event=&quot;navigateToPerson.success&quot;    target=&quot;TOFILL&quot;/&gt;</span>
<span class="cm">        &lt;transition event=&quot;navigateToPerson.personLost&quot; target=&quot;TOFILL&quot;/&gt;</span>
<span class="cm">        &lt;transition event=&quot;navigateToPerson.fatal&quot;      target=&quot;TOFILL&quot;/&gt;</span>
<span class="cm">&lt;/state&gt;</span>

<span class="cm">Look up the skill documentation to see what the options do.</span>
<span class="cm">Only assign values where you differ from the default. otherwise if someone finds</span>
<span class="cm">better working default values you will not profit from that!</span>
<span class="cm">&lt;!--&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../general.html" class="btn btn-neutral float-left" title="Bonsai - Bielefeld Sensor Actuator Interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="general.html" class="btn btn-neutral float-right" title="Bonsai Core Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Leroy Rügemer.
      <span class="lastupdated">Last updated on Jun 10, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>