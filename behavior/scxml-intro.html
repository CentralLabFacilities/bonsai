

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SCXML Definitions &mdash; Bonsai Docs 0.8-SNAPSHOT documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f06a32cd" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f06a32cd" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=3242a324"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SCXML Configuration" href="config.html" />
    <link rel="prev" title="Bonsai - SCXML" href="../behavior.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Bonsai Docs
              <img src="../_static/bonsai-l1s.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">QuickStart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general.html">Bonsai</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../behavior.html">SCXML Behavior Engine</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Intro</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#state">State</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parallel">Parallel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#datamodel">Datamodel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#event-transition">Event/Transition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#regex">Regex</a></li>
<li class="toctree-l4"><a class="reference internal" href="#condition">Condition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#actions">Actions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Send</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Assign</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sourcing">Sourcing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connect-skill-to-state">Connect Skill to State</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implicit-events">Implicit events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#entry-and-exit">.entry and .exit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#change">.change</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Statemachine Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/scxml-skills.html">Integrate Skills in the State Machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/scxml-transition.html">Transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/memory-slots.html">Memory Slots</a></li>
<li class="toctree-l2"><a class="reference internal" href="example/parameter.html">Parameters and Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../general/changes.html">Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bonsai Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../behavior.html">Bonsai - SCXML</a></li>
      <li class="breadcrumb-item active">SCXML Definitions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="scxml-definitions">
<h1>SCXML Definitions<a class="headerlink" href="#scxml-definitions" title="Link to this heading"></a></h1>
<p>We use Apache Commons XML to create our robot behavior.</p>
<p>The Bonsai Engine reads these files to couple simple skills to rich robot behavior.
BonsaiSCXML is not utilizing the whole <a class="reference external" href="http://www.w3.org/TR/scxml/">spec</a>. This page introduces all the relevant parts of SCXML</p>
<section id="state">
<h2>State<a class="headerlink" href="#state" title="Link to this heading"></a></h2>
<p>States define the possible “situations” (or states) the Statemachine can be in.</p>
<p>If the Statemachine is running all current states are called active.</p>
<p>Example State:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;A&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>A state is a XML element with the <code class="docutils literal notranslate"><span class="pre">state</span></code> tag.</p></li>
<li><p>The Attribute <code class="docutils literal notranslate"><span class="pre">id</span></code> is required and defines the <code class="docutils literal notranslate"><span class="pre">StateID</span></code>.</p></li>
</ul>
<p>The root element requires an attribute to denote the starting State of the Statemachine.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scxml</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2005/07/scxml&quot;</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>States can have Substates. The initial Attribute is required and needs to be a child of the parent.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;A&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;B&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;C&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/state&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>If a child is active all parent states are active as well.</p></li>
<li><p>States may have <code class="docutils literal notranslate"><span class="pre">onentry</span></code> and  <code class="docutils literal notranslate"><span class="pre">onexit</span></code> elements which may contain actions(<a class="reference external" href="https://www.w3.org/TR/scxml/#executable">executable content</a>) to be executed on entry or exit of the state.</p></li>
</ul>
<section id="parallel">
<h3>Parallel<a class="headerlink" href="#parallel" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;parallel&gt;</span></code> element encapsulates a set of child states which are simultaneously active when the parent element is active.</p>
<ul class="simple">
<li><p>Parallel has to be exited from the parallel state. (transition outside parallel cant happen in child states)</p></li>
<li><p>More exactly: first child states of parallel should not have transitions.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;parallel</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;Talk&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- Transitions from child states to outside the parallel need to be defined here --&gt;</span>
<span class="w">    </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;DoThingsA.fatal&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;Fatal&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;DoThingsA.success&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;End&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;DoThingsB.fatal&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;Fatal&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;DoThingsB.success&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;End&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;DoThingsA&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- transitions going out of this child state are defined above --&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span>

<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;DoThingsB&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span>

<span class="nt">&lt;/parallel&gt;</span>

<span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;three&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>You can combine compound states with parallel states to run a <cite>sequence of states</cite> in parallel with something else.</p></li>
<li><p>Within the compound states you can only transition to child states of the compound. Otherwise the state machine will break!</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;parallel</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;ParallelState&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- Transitions from child states to outside the parallel need to be defined here --&gt;</span>
<span class="w">    </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;compoundChild.fatal&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;Fatal&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;anotherCompoundChild.*&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;End&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;parallelChild.*&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;End&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;CompoundState&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;compundChild&quot;</span><span class="nt">&gt;</span>

<span class="w">        </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;compoundChild&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;compundChild.success&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;anotherCompoundChild&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/state&gt;</span>

<span class="w">        </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;anotherCompoundChild&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;/state&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span>

<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;parallelChild&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span>

<span class="nt">&lt;/parallel&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="datamodel">
<h2>Datamodel<a class="headerlink" href="#datamodel" title="Link to this heading"></a></h2>
<p>The data model is defined via the <code class="docutils literal notranslate"><span class="pre">&lt;datamodel&gt;</span></code> element, which contains zero or more elements, each of which defines a single data element and assigns an initial value to it.</p>
<ul class="simple">
<li><p>If you want to use the data in guard conditions define the needed data entrys in the root element.</p></li>
<li><p>They can then be updated via the assign action.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scxml</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2005/07/scxml&quot;</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;one&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;datamodel&gt;</span>
<span class="w">    </span><span class="nt">&lt;data</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;&#39;1&#39;&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/datamodel&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">expr</span></code> attribute should use additional single quotes</p></li>
</ul>
</section>
<section id="event-transition">
<h2>Event/Transition<a class="headerlink" href="#event-transition" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Transitions are triggered by events</p></li>
<li><p>They may contain actions, which are executed when the transition is taken</p></li>
<li><p>All active states get checked for matching Transitions beginning with the deepest child.</p></li>
<li><p>If the Transition has the target attribute, a state change is triggered and the active state changes.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;one&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;one&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;b&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<section id="regex">
<h3>Regex<a class="headerlink" href="#regex" title="Link to this heading"></a></h3>
<p>You can use Regex to define events:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;A.*&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>This should be used with caution as there are some <a class="reference internal" href="#implicit-events">Implicit events</a></p>
</section>
<section id="condition">
<h3>Condition<a class="headerlink" href="#condition" title="Link to this heading"></a></h3>
<p>Transition can be conditionalized via guard conditions</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;one&quot;</span><span class="w"> </span><span class="na">cond=</span><span class="s">&quot;number==1&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;b&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>we use <a class="reference external" href="https://commons.apache.org/proper/commons-jexl/reference/syntax.html">JEXL</a> operators</p></li>
</ul>
</section>
</section>
<section id="actions">
<h2>Actions<a class="headerlink" href="#actions" title="Link to this heading"></a></h2>
<p>Actions is the nane of executable content inside <code class="docutils literal notranslate"><span class="pre">onentry</span></code> <code class="docutils literal notranslate"><span class="pre">transition</span></code> and <code class="docutils literal notranslate"><span class="pre">onexit</span></code> elements.</p>
<ul class="simple">
<li><p>we use <a class="reference external" href="https://www.w3.org/TR/scxml/#assign">assign</a> and <a class="reference external" href="https://www.w3.org/TR/scxml/#send">send</a></p></li>
</ul>
<section id="id1">
<h3>Send<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>Send is used to create events</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;send</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;A&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>used in behavior Statemachines</p></li>
</ul>
</section>
<section id="id2">
<h3>Assign<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>Assign is used to update data entrys</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;assign</span><span class="w"> </span><span class="na">location=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="sourcing">
<span id="scxml-sourcing"></span><h2>Sourcing<a class="headerlink" href="#sourcing" title="Link to this heading"></a></h2>
<p>It is possible to use multiple other statemachines by <code class="docutils literal notranslate"><span class="pre">sourcing</span></code> them within your main state machine.
Within your main state machine, you would <strong>source</strong> other xmls <strong>in a state</strong>.</p>
<p>When you source another state machine, when compiling it’s states and transitions are copied into the main state machine.
All <strong>states</strong> and <strong>success</strong>, <strong>error</strong> and <strong>fatal</strong> events of the sub state machine get suffixed by the sourcing state <code class="docutils literal notranslate"><span class="pre">id</span></code> (this includes hashes).
This means that variables defined within a state machine are <strong>global</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>If you define the same variable within mutliple substates  but with different values, the actual value of the parameter is undeterministically one of the defined values <strong>for all</strong> main and sub state machines.</p></li>
<li><p>To reduce the risk of undeterministic robot behavior, don’t define variables with the same name within your state machine and sub state machines.</p></li>
<li><p>See the example below</p></li>
</ul>
</div>
<p>Following things have to be made sure when sourcing other state machines:</p>
<ul class="simple">
<li><p>all sub state machines have to send either success, error, or fatal when exiting</p></li>
<li><p>The main state machine needs transitions for all of the exit tokens, using regex here is not allowed.</p></li>
<li><p>don’t use #suffix in a sourcing state</p></li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span>Document<span class="w"> </span>main.xml:
<span class="nt">&lt;scxml</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2005/07/scxml&quot;</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;datamodel&gt;</span>
<span class="w">        </span><span class="nt">&lt;data</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;param1&quot;</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;&#39;exampleString1&#39;&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/datamodel&gt;</span>

<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;A&quot;</span><span class="w"> </span><span class="na">src=</span><span class="s">&quot;${MAPPING}/b.xml&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/scxml&gt;</span>

-------------------------------------------------------------------------

Document<span class="w"> </span>sub.xml:
<span class="nt">&lt;scxml</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2005/07/scxml&quot;</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;datamodel&gt;</span>
<span class="w">        </span><span class="nt">&lt;data</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;param2&quot;</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;&#39;exampleString2&#39;&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/datamodel&gt;</span>

<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;one&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;C&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span>

<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;C&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;one&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;send</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;success&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/transition&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span>
<span class="nt">&lt;/scxml&gt;</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scxml</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2005/07/scxml&quot;</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- Combined data model from main and sub--&gt;</span>
<span class="w">    </span><span class="nt">&lt;datamodel&gt;</span>
<span class="w">        </span><span class="nt">&lt;data</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;param1&quot;</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;&#39;exampleString1&#39;&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;data</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;param2&quot;</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;&#39;exampleString2&#39;&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/datamodel&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- State machine B has been copied here --&gt;</span>
<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;A&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;B#A&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;B#A&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;one&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;C#A&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/state&gt;</span>

<span class="w">        </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;C#A&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;one&quot;</span><span class="nt">&gt;</span>
<span class="w">                 </span><span class="nt">&lt;send</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;A.success&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/transition&gt;</span>
<span class="w">        </span><span class="nt">&lt;/state&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span>
<span class="nt">&lt;/scxml&gt;</span>
</pre></div>
</div>
</section>
<section id="connect-skill-to-state">
<h2>Connect Skill to State<a class="headerlink" href="#connect-skill-to-state" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Skills are Java Classes that implement <code class="docutils literal notranslate"><span class="pre">AbstraktSkill</span></code>.</p></li>
<li><p>You will find basic skills in Bonsai [Core Skill].</p></li>
<li><p>If the <code class="docutils literal notranslate"><span class="pre">id</span></code> of a state matches the path to a skill the skill gets executed on entry of the state.</p></li>
<li><p>If you have a skill in [Core Skill] under skills/nav called Drive the matching state id would be <code class="docutils literal notranslate"><span class="pre">nav.Drive</span></code>.</p>
<ul>
<li><p>Note that this is due to the fact that at the start of our state machine we set a state prefix with the full path.</p></li>
</ul>
</li>
<li><p>To have different states using the same skill you can differentiate between them using # in the state <code class="docutils literal notranslate"><span class="pre">id</span></code></p></li>
</ul>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span>...

<span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;nav.Drive#toKitchen&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span>...
<span class="nt">&lt;/state&gt;</span>

...

<span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;nav.Drive#away&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span>...
<span class="nt">&lt;/state&gt;</span>

...
</pre></div>
</div>
</section>
<section id="implicit-events">
<h2>Implicit events<a class="headerlink" href="#implicit-events" title="Link to this heading"></a></h2>
<p>Commons SCXML provides some <strong>interesting</strong> extensions, generating some internal events automatically. As they are named &lt;ID&gt;.&lt;event&gt; you may accidentally cause transitions while using regex as transition events for Skills (e.x. <code class="docutils literal notranslate"><span class="pre">id=&quot;Wait&quot;</span></code>) or Compount States (<a class="reference internal" href="#sourcing">Sourcing</a>)</p>
<section id="entry-and-exit">
<h3>.entry and .exit<a class="headerlink" href="#entry-and-exit" title="Link to this heading"></a></h3>
<p>The Commons SCXML implementation generates a <code class="docutils literal notranslate"><span class="pre">.entry</span></code> event when any state is entered and a <code class="docutils literal notranslate"><span class="pre">.exit</span></code> when a state is exited.</p>
</section>
<section id="change">
<h3>.change<a class="headerlink" href="#change" title="Link to this heading"></a></h3>
<p>Similarly to the <code class="docutils literal notranslate"><span class="pre">.entry</span></code> and <code class="docutils literal notranslate"><span class="pre">.exit</span></code> event the Commons SCXML implementation generates a <code class="docutils literal notranslate"><span class="pre">.change</span></code> event when a piece of any data model changes, which means one can watch some part of the datamodel for an update for triggering a transition. This is quite useful for communicating across regions etc.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;scxml</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2005/07/scxml&quot;</span>
<span class="w">    </span><span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;main&quot;</span><span class="nt">&gt;</span>

<span class="nt">&lt;datamodel&gt;</span>
<span class="w">    </span><span class="nt">&lt;data</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;current&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/datamodel&gt;</span>

<span class="nt">&lt;parallel</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;main&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- &quot;master&quot; state machine --&gt;</span>
<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;master&quot;</span><span class="w"> </span><span class="na">initial=</span><span class="s">&quot;state_1&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;state_1&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;someevent&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;state_2&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/state&gt;</span>
<span class="w">        </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;state_2&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;someevent&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;state_3&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/state&gt;</span>
<span class="w">        </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;state_3&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;someevent&quot;</span><span class="w"> </span><span class="na">target=</span><span class="s">&quot;state_1&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/state&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span><span class="w"> </span><span class="cm">&lt;!-- end state master --&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- &quot;slave&quot; state machine --&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- this state machine acts on .entry events of our master state machine --&gt;</span>
<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;slave&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;state_1.entry&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;assign</span><span class="w"> </span><span class="na">location=</span><span class="s">&quot;current&quot;</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;&#39;state_1&#39;&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/transition&gt;</span>
<span class="w">        </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;state_2.entry&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;assign</span><span class="w"> </span><span class="na">location=</span><span class="s">&quot;current&quot;</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;&#39;state_2&#39;&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/transition&gt;</span>
<span class="w">        </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;state_3.entry&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;assign</span><span class="w"> </span><span class="na">location=</span><span class="s">&quot;current&quot;</span><span class="w"> </span><span class="na">expr=</span><span class="s">&quot;&#39;state_3&#39;&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/transition&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span><span class="w"> </span><span class="cm">&lt;!-- end of slave --&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- watch for data model changes --&gt;</span>
<span class="w">    </span><span class="nt">&lt;state</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;watch_changes&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;transition</span><span class="w"> </span><span class="na">event=</span><span class="s">&quot;current.change&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="cm">&lt;!-- duh --&gt;</span>
<span class="w">        </span><span class="nt">&lt;/transition&gt;</span>
<span class="w">    </span><span class="nt">&lt;/state&gt;</span>

<span class="nt">&lt;/parallel&gt;</span>
<span class="nt">&lt;/scxml&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../behavior.html" class="btn btn-neutral float-left" title="Bonsai - SCXML" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="config.html" class="btn btn-neutral float-right" title="SCXML Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Team of Bielefeld.
      <span class="lastupdated">Last updated on Dec 04, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>